#!/bin/bash

echo "======================================"
echo "  ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ - åˆ†ç³»ç»Ÿæ‰“åŒ…"
echo "======================================"
echo ""

# è®¾ç½®å˜é‡
TODAY=$(date +%Y%m%d)
PROJECT_DIR="/Users/lijiahao/Desktop/project/grade-analysis-system"
DEST_BASE="$HOME/Desktop"

# 1. æž„å»ºé¡¹ç›®
echo "ðŸ“¦ æ­¥éª¤1/5: æ­£åœ¨æž„å»ºWebåº”ç”¨..."
cd "$PROJECT_DIR"
npm run build

if [ ! -f "dist/index.html" ]; then
    echo "âŒ æž„å»ºå¤±è´¥ï¼è¯·æ£€æŸ¥é”™è¯¯ä¿¡æ¯"
    exit 1
fi

echo "âœ… æž„å»ºå®Œæˆ"
echo ""

# 2. åˆ›å»º Windows ç‰ˆæœ¬
echo "ðŸ“ æ­¥éª¤2/5: æ­£åœ¨åˆ›å»º Windows ç‰ˆæœ¬..."
WIN_FOLDER="$DEST_BASE/ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ_Windowsç‰ˆ_$TODAY"
mkdir -p "$WIN_FOLDER"

cp dist/index.html "$WIN_FOLDER/index.html"
cp æ™ºèƒ½å¯åŠ¨.bat "$WIN_FOLDER/"
cp å¯åŠ¨ç¨‹åº_æœåŠ¡å™¨.bat "$WIN_FOLDER/"

# åˆ›å»º Windows ä½¿ç”¨è¯´æ˜Ž
cat > "$WIN_FOLDER/ä½¿ç”¨è¯´æ˜Ž.txt" << 'EOF'
========================================
  ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ - Windowsç‰ˆ
========================================

ã€å¿«é€Ÿå¼€å§‹ã€‘â­

1. åŒå‡»"æ™ºèƒ½å¯åŠ¨.bat"
2. ç­‰å¾…3ç§’ï¼Œæµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€
3. å¼€å§‹ä½¿ç”¨ï¼

âœ“ è‡ªåŠ¨æŸ¥æ‰¾å¯ç”¨ç«¯å£
âœ“ è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
âœ“ æ•°æ®å®‰å…¨å¯é 

========================================

ã€ç³»ç»Ÿè¦æ±‚ã€‘

éœ€è¦å®‰è£… Pythonï¼ˆå¤§éƒ¨åˆ†ç”µè„‘å·²è‡ªå¸¦ï¼‰

å¦‚æžœåŒå‡»å¯åŠ¨åŽæç¤º"æœªå®‰è£…Python"ï¼š
1. è®¿é—® https://www.python.org/downloads/
2. ä¸‹è½½å¹¶å®‰è£…æœ€æ–°ç‰ˆ Python
3. å®‰è£…æ—¶åŠ¡å¿…å‹¾é€‰ "Add Python to PATH"
4. å®‰è£…å®ŒæˆåŽé‡æ–°åŒå‡»"æ™ºèƒ½å¯åŠ¨.bat"

========================================

ã€ä½¿ç”¨æ­¥éª¤ã€‘

é¦–æ¬¡ä½¿ç”¨ï¼š
1. ç‚¹å‡»"é…ç½®ç§‘ç›®å¹¶ä¸‹è½½æ¨¡æ¿"
2. åœ¨ä¸‹è½½çš„ Excel ä¸­å¡«å†™å­¦ç”Ÿæˆç»©
3. ä¸Šä¼ å¡«å¥½çš„æˆç»©è¡¨
4. æŸ¥çœ‹è‡ªåŠ¨ç”Ÿæˆçš„åˆ†æžæŠ¥å‘Š

æ—¥å¸¸ä½¿ç”¨ï¼š
1. åŒå‡»"æ™ºèƒ½å¯åŠ¨.bat"å¯åŠ¨ç³»ç»Ÿ
2. ä¸Šä¼ æ–°çš„æˆç»©è¡¨
3. æŸ¥çœ‹åˆ†æžç»“æžœ
4. å¯¼å‡ºå­¦ç”ŸæŠ¥å‘Šï¼ˆå¯é€‰ï¼‰

========================================

ã€é‡è¦æç¤ºã€‘âš ï¸

âœ“ è¯·ä¿æŒå¯åŠ¨çª—å£æ‰“å¼€ï¼Œå…³é—­çª—å£ä¼šåœæ­¢ç³»ç»Ÿ
âœ“ ä½¿ç”¨å®Œæ¯•åŽï¼ŒæŒ‰ Ctrl+C åœæ­¢æœåŠ¡å™¨
âœ“ å»ºè®®å®šæœŸå¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹å¤‡ä»½æ•°æ®
âœ“ å¯ä»¥å¤åˆ¶åˆ° U ç›˜åœ¨å…¶ä»–ç”µè„‘ä½¿ç”¨

========================================

ã€å¸¸è§é—®é¢˜ã€‘

Q1: åŒå‡»åŽæ²¡ååº”ï¼Ÿ
A: å³é”®"æ™ºèƒ½å¯åŠ¨.bat" â†’ ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ

Q2: æç¤º"ç«¯å£è¢«å ç”¨"ï¼Ÿ
A: ä½¿ç”¨"æ™ºèƒ½å¯åŠ¨.bat"ä¼šè‡ªåŠ¨æ¢ç«¯å£ï¼Œæ— éœ€æ‹…å¿ƒ

Q3: æ•°æ®ä¼šä¸¢å¤±å—ï¼Ÿ
A: æ•°æ®ä¿å­˜åœ¨æµè§ˆå™¨ä¸­ï¼Œåªè¦ä½¿ç”¨åŒä¸€å°ç”µè„‘å’Œæµè§ˆå™¨ï¼Œæ•°æ®å°±ä¸ä¼šä¸¢å¤±
   å»ºè®®å®šæœŸå¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹å¤‡ä»½

Q4: å¯ä»¥åˆ†äº«ç»™å…¶ä»–è€å¸ˆå—ï¼Ÿ
A: å¯ä»¥ï¼å¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹ç»™å…¶ä»–è€å¸ˆå³å¯

Q5: å¦‚æžœæœ‰é—®é¢˜æ€Žä¹ˆåŠžï¼Ÿ
A: è”ç³»æŠ€æœ¯æ”¯æŒï¼š
   ðŸ“§ é‚®ç®±ï¼šsupport@example.com
   ðŸ“± å¾®ä¿¡ï¼šyour-wechat-id

========================================

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ðŸŽ‰
EOF

echo "âœ… Windows ç‰ˆæœ¬åˆ›å»ºå®Œæˆ"
echo ""

# 3. åˆ›å»º Mac ç‰ˆæœ¬
echo "ðŸ“ æ­¥éª¤3/5: æ­£åœ¨åˆ›å»º Mac ç‰ˆæœ¬..."
MAC_FOLDER="$DEST_BASE/ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ_Macç‰ˆ_$TODAY"
mkdir -p "$MAC_FOLDER"

cp dist/index.html "$MAC_FOLDER/index.html"
cp æ™ºèƒ½å¯åŠ¨.command "$MAC_FOLDER/"
cp å¯åŠ¨ç¨‹åº_æœåŠ¡å™¨.command "$MAC_FOLDER/"
chmod +x "$MAC_FOLDER/æ™ºèƒ½å¯åŠ¨.command"
chmod +x "$MAC_FOLDER/å¯åŠ¨ç¨‹åº_æœåŠ¡å™¨.command"

# åˆ›å»º Mac ä½¿ç”¨è¯´æ˜Ž
cat > "$MAC_FOLDER/ä½¿ç”¨è¯´æ˜Ž.txt" << 'EOF'
========================================
  ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ - Macç‰ˆ
========================================

ã€å¿«é€Ÿå¼€å§‹ã€‘â­

1. åŒå‡»"æ™ºèƒ½å¯åŠ¨.command"
2. ç­‰å¾…3ç§’ï¼Œæµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€
3. å¼€å§‹ä½¿ç”¨ï¼

âœ“ è‡ªåŠ¨æŸ¥æ‰¾å¯ç”¨ç«¯å£
âœ“ è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
âœ“ æ•°æ®å®‰å…¨å¯é 

========================================

ã€ç³»ç»Ÿè¦æ±‚ã€‘

Mac ç³»ç»Ÿè‡ªå¸¦ Pythonï¼Œæ— éœ€é¢å¤–å®‰è£…

é¦–æ¬¡ä½¿ç”¨å¯èƒ½éœ€è¦æŽˆæƒï¼š
- åŒå‡»åŽå¦‚æžœæ²¡ååº”
- å³é”®æ–‡ä»¶ â†’ æ‰“å¼€ â†’ ç¡®è®¤æ‰“å¼€
- ä¹‹åŽå°±å¯ä»¥ç›´æŽ¥åŒå‡»ä½¿ç”¨

========================================

ã€ä½¿ç”¨æ­¥éª¤ã€‘

é¦–æ¬¡ä½¿ç”¨ï¼š
1. ç‚¹å‡»"é…ç½®ç§‘ç›®å¹¶ä¸‹è½½æ¨¡æ¿"
2. åœ¨ä¸‹è½½çš„ Excel ä¸­å¡«å†™å­¦ç”Ÿæˆç»©
3. ä¸Šä¼ å¡«å¥½çš„æˆç»©è¡¨
4. æŸ¥çœ‹è‡ªåŠ¨ç”Ÿæˆçš„åˆ†æžæŠ¥å‘Š

æ—¥å¸¸ä½¿ç”¨ï¼š
1. åŒå‡»"æ™ºèƒ½å¯åŠ¨.command"å¯åŠ¨ç³»ç»Ÿ
2. ä¸Šä¼ æ–°çš„æˆç»©è¡¨
3. æŸ¥çœ‹åˆ†æžç»“æžœ
4. å¯¼å‡ºå­¦ç”ŸæŠ¥å‘Šï¼ˆå¯é€‰ï¼‰

========================================

ã€é‡è¦æç¤ºã€‘âš ï¸

âœ“ è¯·ä¿æŒç»ˆç«¯çª—å£æ‰“å¼€ï¼Œå…³é—­çª—å£ä¼šåœæ­¢ç³»ç»Ÿ
âœ“ ä½¿ç”¨å®Œæ¯•åŽï¼ŒæŒ‰ Ctrl+C åœæ­¢æœåŠ¡å™¨
âœ“ å»ºè®®å®šæœŸå¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹å¤‡ä»½æ•°æ®
âœ“ å¯ä»¥å¤åˆ¶åˆ° U ç›˜åœ¨å…¶ä»– Mac ç”µè„‘ä½¿ç”¨

========================================

ã€å¸¸è§é—®é¢˜ã€‘

Q1: åŒå‡»åŽæ²¡ååº”ï¼Ÿ
A: å³é”®æ–‡ä»¶ â†’ æ‰“å¼€ â†’ ç¡®è®¤æ‰“å¼€
   ï¼ˆé¦–æ¬¡ä½¿ç”¨éœ€è¦æŽˆæƒï¼Œä¹‹åŽå°±æ­£å¸¸äº†ï¼‰

Q2: æç¤º"ç«¯å£è¢«å ç”¨"ï¼Ÿ
A: ä½¿ç”¨"æ™ºèƒ½å¯åŠ¨.command"ä¼šè‡ªåŠ¨æ¢ç«¯å£ï¼Œæ— éœ€æ‹…å¿ƒ

Q3: æ•°æ®ä¼šä¸¢å¤±å—ï¼Ÿ
A: æ•°æ®ä¿å­˜åœ¨æµè§ˆå™¨ä¸­ï¼Œåªè¦ä½¿ç”¨åŒä¸€å°ç”µè„‘å’Œæµè§ˆå™¨ï¼Œæ•°æ®å°±ä¸ä¼šä¸¢å¤±
   å»ºè®®å®šæœŸå¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹å¤‡ä»½

Q4: å¯ä»¥åˆ†äº«ç»™å…¶ä»–è€å¸ˆå—ï¼Ÿ
A: å¯ä»¥ï¼å¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹ç»™å…¶ä»–è€å¸ˆå³å¯

Q5: å¦‚æžœæœ‰é—®é¢˜æ€Žä¹ˆåŠžï¼Ÿ
A: è”ç³»æŠ€æœ¯æ”¯æŒï¼š
   ðŸ“§ é‚®ç®±ï¼šsupport@example.com
   ðŸ“± å¾®ä¿¡ï¼šyour-wechat-id

========================================

ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼ðŸŽ‰
EOF

echo "âœ… Mac ç‰ˆæœ¬åˆ›å»ºå®Œæˆ"
echo ""

# 4. åˆ›å»ºåŽ‹ç¼©åŒ…
echo "ðŸ“¦ æ­¥éª¤4/5: æ­£åœ¨åˆ›å»ºåŽ‹ç¼©åŒ…..."
cd "$DEST_BASE"

# åˆ é™¤æ—§çš„åŽ‹ç¼©åŒ…
rm -f "ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ_Windowsç‰ˆ_$TODAY.zip"
rm -f "ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ_Macç‰ˆ_$TODAY.zip"

# åˆ›å»ºæ–°åŽ‹ç¼©åŒ…
zip -q -r "ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ_Windowsç‰ˆ_$TODAY.zip" "ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ_Windowsç‰ˆ_$TODAY"
zip -q -r "ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ_Macç‰ˆ_$TODAY.zip" "ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ_Macç‰ˆ_$TODAY"

echo "âœ… åŽ‹ç¼©åŒ…åˆ›å»ºå®Œæˆ"
echo ""

# 5. æ˜¾ç¤ºç»“æžœ
echo "======================================"
echo "âœ… æ‰“åŒ…å®Œæˆï¼"
echo "======================================"
echo ""
echo "ðŸ“¦ Windows ç‰ˆæœ¬ï¼š"
echo "   æ–‡ä»¶å¤¹: $WIN_FOLDER"
echo "   åŽ‹ç¼©åŒ…: $DEST_BASE/ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ_Windowsç‰ˆ_$TODAY.zip"
ls -lh "$WIN_FOLDER"
echo ""
echo "ðŸ“¦ Mac ç‰ˆæœ¬ï¼š"
echo "   æ–‡ä»¶å¤¹: $MAC_FOLDER"
echo "   åŽ‹ç¼©åŒ…: $DEST_BASE/ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ_Macç‰ˆ_$TODAY.zip"
ls -lh "$MAC_FOLDER"
echo ""
echo "ðŸ“Š åŽ‹ç¼©åŒ…å¤§å°ï¼š"
ls -lh "$DEST_BASE/ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ_Windowsç‰ˆ_$TODAY.zip"
ls -lh "$DEST_BASE/ç¿æžæˆç»©åˆ†æžç³»ç»Ÿ_Macç‰ˆ_$TODAY.zip"
echo ""
echo "ðŸ’¡ å‘é€å»ºè®®ï¼š"
echo "Windows è€å¸ˆ â†’ å‘é€ Windows ç‰ˆåŽ‹ç¼©åŒ…"
echo "Mac è€å¸ˆ     â†’ å‘é€ Mac ç‰ˆåŽ‹ç¼©åŒ…"
echo "ä¸ç¡®å®š      â†’ ä¸¤ä¸ªéƒ½å‘é€ï¼Œè®©è€å¸ˆé€‰æ‹©"
echo ""

# è¯¢é—®æ˜¯å¦æ‰“å¼€æ–‡ä»¶å¤¹
read -p "æ˜¯å¦çŽ°åœ¨æ‰“å¼€æ–‡ä»¶å¤¹æŸ¥çœ‹ï¼Ÿ(y/n): " choice
if [ "$choice" = "y" ] || [ "$choice" = "Y" ]; then
    open "$DEST_BASE"
fi

echo ""
echo "ðŸŽ‰ ç¥æ‚¨é”€å”®é¡ºåˆ©ï¼"
